#!/bin/bash
# Generate minutes from completed recording
# Usage: ./finish [bot-id]

cd "$(dirname "$0")"

BOT_ID=$1

# If no bot ID provided, try to read from .last-bot file
if [ -z "$BOT_ID" ]; then
  if [ -f ".last-bot" ]; then
    BOT_ID=$(cat .last-bot)
    echo "ğŸ“ Using saved Bot ID: $BOT_ID"
    echo ""
  else
    echo "âŒ No Bot ID found!"
    echo ""
    echo "Usage: ./finish [bot-id]"
    echo ""
    echo "Example:"
    echo "  ./finish 1cae48d7-c234-4a55-ad74-060a9b1e6ab7"
    echo ""
    echo "ğŸ’¡ Tip: Run './bot <url>' first to start recording"
    exit 1
  fi
fi

echo "ğŸ¤– AIMeet - Generating Minutes"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“ Processing bot: $BOT_ID"
echo "â³ Fetching transcript & generating minutes..."
echo ""

npm run process-meeting -- --bot "$BOT_ID" --output "meeting.md"

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Done!"
echo ""
echo "ğŸ“‚ Files saved to:"
echo "   - Record/YYYY/MM/meeting-*.md (è­°äº‹éŒ²)"
echo "   - Agenda/YYYY/MM/agenda-*.md (æ¬¡å›ã‚¢ã‚¸ã‚§ãƒ³ãƒ€)"
